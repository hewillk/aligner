#!/usr/bin/bash

gatk=~/software/gatk-4.1.8.1/gatk
sample=$1

chrom=(
1:1-100000000
1:100000001-200000000
1:200000001-249250621
2:1-100000000
2:100000001-200000000
2:200000001-243199373
3:1-100000000
3:100000001-198022430
4:1-100000000
4:100000001-191154276
5:1-100000000
5:100000001-180915260
6:1-50000000
6:50000001-100000000
6:100000001-171115067
7:1-70000000
7:70000001-159138663
8:1-70000000
8:70000001-146364022
9:1-70000000
9:70000001-141213431
10:1-70000000
10:70000001-135534747
11:1-70000000
11:70000001-135006516
12:1-70000000
12:70000001-133851895
13:1-50000000
13:50000001-115169878
14:1-50000000
14:50000001-107349540
15:1-50000000
15:50000001-102531392
16:1-25000000
16:25000001-50000000
16:50000001-90354753
17:1-40000000
17:40000001-81195210
18:1-40000000
18:40000001-78077248
19:1-30000000
19:30000001-59128983
20:1-30000000
20:30000001-63025520
21:1-25000000
21:25000001-48129895
22:1-25000000
22:25000001-51304566
X:1-50000000
X:50000001-100000000
X:100000001-155270560
)

merge_vcfs=""
for i in ${chrom[@]}; do
    merge_vcfs=${merge_vcfs}" -I output/${sample}.${i}.vcf.gz "
done
(time $gatk MergeVcfs ${merge_vcfs} \
  -O output/${sample}.vcf.gz \
  && echo "** merge vcf done **") > log/${sample}.merge.log 2>&1

for i in ${chrom[@]}; do
    tail -n 1 log/${sample}.${i}.log
    rm -f output/${sample}.${i}.vcf.gz*
    rm -f log/${sample}.${i}.log
done

tail -n 1 log/${sample}.merge.log
rm log/${sample}.merge.log
